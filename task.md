# 발길맵 (Footprint Map) 개발 태스크

## Phase 1: 초기 UI 및 지도 인터페이스 설계 (완료)
- [x] 프로젝트 기획안 분석 및 구조화
- [x] 초기 화면 (스플래시 + 온보딩) UI 설계
  - [x] 캐릭터 스플래시 화면 구현 (발자국 모양 마스크 + 애니메이션)
- [x] 메인 지도 인터페이스 설계 (V-world/OSM)
- [x] 카카오 지오코딩 API 연동 (REST API Proxy 방식 - 도메인 우회)
- [x] 도로 기반 경로 안내 구현 (OSRM API)
- [x] 목적지 설정 제스처 개선 (더블클릭/투터치, 드래그)
- [x] 앱 아이콘 제작 및 적용 (`icon.png`)
- [x] 플로팅 오버레이 UI 설계 (데모)

## Phase 2: 핵심 기능 구현 (진행 중)
- [ ] V-world 배경지도 정식 적용 (API 키 필요)
- [x] 검색어 자동완성 (추천 검색어 목록) 구현
- [x] 경로 안내 시 전체 경로(LineString) 뷰 피팅 개선
- [x] 경로 안내 모드 UI (검색창 숨김 처리)
- [x] 경로 안내 중 경유지/새 목적지 설정 팝업
- [x] 경유지 및 목적지 순서 번호 표시 (1, 2...)
  - [x] 초기 목적지 번호 숨김 처리 (경유지 없을 시)
- [x] 사용자 위치 마커 방향성(화살표) 적용 및 회전 구현
  - [x] 정지 시 원형, 이동 시 화살표 자동 전환 기능 추가
- [x] 지도 가독성 및 상세 정보 개선 (CartoDB -> Google Maps XYZ)
  - [x] 서체/해상도 개선 및 건물명/동번호 상세 정보 복구 (Google Maps Standard 적용)
  - [x] 서체/해상도 개선 및 건물명/동번호 상세 정보 복구 (Google Maps Standard 적용)
- [x] 경로 안내 HUD (Turn-by-Turn) 구현
  - [x] 상단 검색창 대체 UI (투명 배경, 굵은 글씨)
  - [x] 정보 구성: [다음 턴] | [그 다음 턴] | [잔여 거리/시간]
- [x] 경로 가시성 개선 (Chevron/화살표 스타일 적용)
  - [x] 진행 방향 꺽쇠( > > > ) 패턴 적용
- [x] 하단 정보창 개선 (Context Dashboard)
  - [x] 단순 버튼 -> 대시보드 UI 변경 (좌측: 상세정보, 우측: 종료/신고)
  - [x] 모드별 정보 표시 (보행: 상세주소/요청사항, 휠체어: 경사도)
- [x] 검색창 UI 개선 (Search Bar Redesign)
  - [x] 돋보기 아이콘 우측 분리 배치
  - [x] 검색어 입력 시 'X (삭제)' 버튼 표시 및 기능 구현
- [x] 경로 안내 HUD 가독성 (HUD Visibility)
  - [x] 주요 턴 정보(거리/방향) 중앙 배치 및 크기 확대 (Primary)
  - [x] 다음 턴 및 전체 정보 포맷 통일 및 상단 기준선 정렬 (Secondary/Alignment)
- [x] 경유지/목적지 설정 옵션 개선 (Waypoint Options)
  - [x] 투터치 메뉴: '새 목적지로 설정', '경유지로 추가', '최종 목적지로 추가', '취소'
  - [x] '최종 목적지로 추가' 로직 구현 (기존 목적지 -> 경유지 전환)
- [x] 위치 기반 커뮤니케이션 (Social Features)
  - [x] 하단 버튼 분할 (대화 / 작성 / 경로안내)
  - [x] 메시지 작성 기능 (140자, 현위치 저장, 수정/삭제)
  - [x] 메시지 조회 기능 (지도 영역 내 좋아요 순 상위 노출, 좋아요/싫어요/공유)
  - [x] 주행 중 하단 바 개선 (주소 3초 토글, 목적지 베스트 메시지 노출)
- [/] 코드 구조 개선 (Refactoring)
  - [x] MapManager 기능 분리 (RouteManager, PathManager 도입)
  - [ ] 검증 체크리스트 작성 (Verification Checklist)
  - [x] app.js 모듈 분리 (MapManager, UIManager, SocialManager, Utils)
  - [x] 파일 구조 재배치 (js 폴더 생성)
- [x] 사이드 메뉴 개편 (Side Menu Overhaul)
  - [x] 프로필 영역 추가 (사진/별명 수정 기능, 랜덤 별명 생성)
  - [x] '설정' 메뉴 삭제 및 '나의 기록' 메뉴 최상단 배치
  - [x] '나의 기록' 랭킹 시스템 (누적 거리, 사진/별명 포함 리더보드)
  - [x] 하단 앱 버전 정보 (Footer) 추가
- [x] 클립보드 리스너 기능 (제로-터치 목적지 설정)
- [x] 센서 기반 이동수단 판별 로직
- [x] 사용자 이동 경로 수집 및 시각화
- [x] 집단지성 궤적 오버레이 표시
- [x] 하단 대시보드 정보 개선
  - [x] 목적지 변경 시(최종 목적지로 추가) 대시보드 텍스트 업데이트
  - [x] 현위치 표시를 좌표 대신 주소로 변환 (Reverse Geocoding)
- [x] 대화 작성창 플로팅 라벨 5초 후 자동 숨김
- [x] 앱 성능 최적화 (지도 초기화 속도 개선, 궤적 렌더링 최적화)
- [x] 지도 범례(Legend) 위치 이동
  - [x] 우측 하단 고정 -> 사이드 메뉴 최하단 배치
  - [x] 토글 방식(Click to Expand) 구현
- [x] 경로 안내 지속성 (Seamless Navigation Persistence) 구현
    - [x] `js/data_collector.js`: IndexedDB v2 업그레이드 및 세션 스토어 추가
    - [x] `js/data_collector.js`: 세션 저장/로드/삭제 및 검증 로직 구현
    - [x] `js/ui_manager.js`: 안내 시작/종료 시 세션 상태 연동
    - [x] `js/map_manager.js`: 위치 업데이트 시 10초 주기(Throttle) 세션 저장
    - [x] `js/app.js`: 앱 실행 시 세션 복원 및 타임아웃 처리 로직 추가
    - [x] `js/app.js`: `beforeunload` 이벤트로 종료 시 강제 저장 추가

## Phase 3: 백엔드 및 데이터 에코시스템
- [x] Flask + SQLite 백엔드 구현 (메시지 API)
- [x] 환경 변수 기반 자동 DB 전환 전략 (개발:SQLite / 배포:PostgreSQL)
- [ ] 사용자 경로 데이터 서버 전송
- [ ] 궤적 데이터 분석 및 통합
- [ ] 실시간 업데이트 시스템

## Phase 4: 대화(Talk) 기능 고도화
> 상세 명세: `talk_feature_spec.md` 참조

- [x] 말풍선 꼬리 UI (해당 장소 방향 지시)
- [x] 댓글 시스템 (DB 스키마 변경)
- [x] 반응형 노출 개수 (화면 크기에 따라 3~5개)
- [x] 플로팅 모드 목적지 메시지 (주소 매칭 로직)
- [x] 0.3초 지연 애니메이션

## Phase 5: 프로젝트 관리 및 형상 관리
- [x] [Governance] 독단적 수정 금지 및 승인 체계 수립
- [x] [Snapshot] 작성창(Write Modal) 작업 완료 스냅샷 생성

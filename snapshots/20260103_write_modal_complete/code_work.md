# 🛠️ AI 코드 작업 규칙 (Code Work Rules)

AI가 이 프로젝트의 파일을 수정할 때 반드시 지켜야 하는 **작업 방식 규칙**입니다.
(`coding_rules.md`는 코드 품질 규칙, 이 파일은 도구 사용 규칙)

---

## 1. 📏 정밀 수정 원칙 (Surgical Modification)

- **Rule**: 파일 전체를 덮어쓰지 말 것. 필요한 줄만 정밀하게 수정할 것.
- **Action**: `replace_file_content` 또는 `multi_replace_file_content` 도구를 우선 사용. `Overwrite: true`는 파일이 완전히 새로 만들어지는 경우에만 허용.
- **Why**: 전체 덮어쓰기는 기존 코드 누락, 인코딩 손상, 의도치 않은 삭제를 유발함.

---

## 2. 🔡 인코딩 무결성 (Encoding Integrity)

- **Rule**: 모든 파일 작업은 UTF-8로 처리할 것.
- **Action**: PowerShell 명령 사용 시 `-Encoding UTF8` 옵션을 명시적으로 추가. 시스템 기본 인코딩(CP949 등)에 의존하지 말 것.
- **Why**: 인코딩 불일치는 한글 깨짐, CSS 파싱 실패, JavaScript 구문 오류를 유발함.

---

## 3. 🔍 수정 전 분석 의무 (Analysis Before Edit)

- **Rule**: 파일을 수정하기 전에 해당 영역의 **현재 상태**를 반드시 확인할 것.
- **Action**: `view_file` 또는 `grep_search`로 수정 대상 라인을 먼저 읽고, 예상되는 변경과 일치하는지 확인 후 수정할 것.
- **Why**: 이전 작업에서 이미 변경된 내용을 모르고 덮어쓰면 작업이 롤백되거나 충돌함.

---

## 4. ⚠️ 스냅샷 복원 금지 (No Blind Snapshot Restore)

- **Rule**: 과거 스냅샷을 "전체 복사"하여 현재 파일에 붙여넣지 말 것.
- **Action**: 스냅샷에서 필요한 부분만 추출하여 정밀하게 병합할 것. 복원 전 스냅샷의 무결성(줄 수, 인코딩)을 검증할 것.
- **Why**: 잘린(truncated) 스냅샷이나 인코딩이 다른 파일을 덮어쓰면 대규모 기능 손실이 발생함.

---

## 5. 🧹 작업 후 검증 (Post-Edit Verification)

- **Rule**: 파일 수정 후 해당 파일의 구조적 무결성을 확인할 것.
- **Action**: 수정 후 `view_file`로 변경된 영역을 다시 읽어 의도대로 적용되었는지 확인. 가능하면 브라우저에서 시각적 검증 수행.
- **Why**: 도구 오류나 인코딩 문제로 의도와 다르게 적용되는 경우가 있음.

---

## 6. 🛂 명시적 승인 원칙 (Explicit User Approval)

- **Rule**: 모든 기술적 결정과 코드 수정은 독단적으로 실행하지 않는다.
- **Action**: 수정이 필요한 이유와 방법(행 번호, 수정 내용 등)을 담은 계획을 먼저 보고하고, 사용자의 확답을 받은 직후에만 실행한다. 계획되지 않은 '덤' 수정은 절대 금지한다.
- **Why**: AI의 자율적인 판단은 코드의 파편화를 초래하고 사용자의 설계 의도를 파괴할 위험이 크기 때문이다.
